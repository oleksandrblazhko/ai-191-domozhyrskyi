# Тестування на виконання JavaScript

## Короткий опис

Вразливість на внесення JavaScript - це підтип міжсайтового сценарію (XSS), який включає можливість вводити довільний код JavaScript, який виконується застосунком у браузері жертви. Ця вразливість може мати багато наслідків, таких як розкриття сеансових файлів cookie користувача, які можуть використовуватися для імітації жертви, або, загалом, вона може дозволити атакуючому змінювати вміст сторінки, який бачать жертви, або поведінку застосунку.
Вразливості на внесення JavaScript можуть виникати, коли застосунок не має належної перевірки введення і виведення від користувача. Оскільки JavaScript використовується для динамічного заповнення веб-сторінок, такий внесок відбувається під час обробки вмісту і, відповідно, впливає на жертву.

Під час перевірки цієї вразливості варто враховувати, що деякі символи різними браузерами обробляються по-різному.

Ось приклад сценарію, який не здійснює жодної перевірки змінної rr. Змінна містить ввід, отриманий від користувача через рядок запиту, і додатково не застосовує жодного виду кодування:

var rr = location.search.substring(1);
if(rr) {
    window.location=decodeURIComponent(rr);
}

Це означає, що атакувач може вводити код JavaScript, просто надсилаючи наступний рядок запиту: www.victim.com/?javascript:alert(1).

## Цілі тестування

Визначення вразливих місць та можливих точок внесення JavaScript.

## Як тестувати

Сторінка містить наступний скрипт:
<script>
function loadObj(){
    var cc=eval('('+aMess+')');
    document.getElementById('mess').textContent=cc.message;
}

if(window.location.hash.indexOf('message')==-1) {
    var aMess='({"message":"Hello User!"})';
} else {
    var aMess=location.hash.substr(window.location.hash.indexOf('message=')+8)
}
</script>
Вище наведений код містить джерело location.hash, яке контролюється атакувачем і може вводити прямо в значення message код JavaScript, щоб прийняти керування браузером користувача.